---
title: "Class 5 - ML in genomics: Exploratory Data Analysis of Palmer Penguins"
author: "Renan Escalante"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Introduction

In this document, we'll perform an Exploratory Data Analysis (EDA) of the Palmer Penguins dataset, focusing on comparing different variables between male and female penguins.

## Load Required Libraries

```{r load_libraries}
library(tidyverse)
library(palmerpenguins)
library(GGally)
library(skimr)
```

## Load and Inspect the Data

```{r load_data}
data("penguins")
glimpse(penguins)
```

## Data Cleaning

Let's remove any rows with missing values and ensure 'sex' is a factor.

```{r clean_data}
penguins_clean <- penguins %>%
  drop_na() %>%
  mutate(sex = as.factor(sex))

# Check for any remaining missing values
sum(is.na(penguins_clean))
```

## Summary Statistics

Let's get a summary of our cleaned dataset.

```{r summary_stats}
skim(penguins_clean)
```

## Visualizations

### Distribution of Species by Sex

```{r species_sex_dist}
ggplot(penguins_clean, aes(x = species, fill = sex)) +
  geom_bar(position = "dodge") +
  labs(title = "Distribution of Species by Sex",
       x = "Species", y = "Count") +
  theme_minimal()
```

### Comparison of Numeric Variables by Sex

```{r numeric_vars_by_sex}
penguins_clean %>%
  select(sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g) %>%
  pivot_longer(cols = -sex, names_to = "variable", values_to = "value") %>%
  ggplot(aes(x = sex, y = value, fill = sex)) +
  geom_boxplot() +
  facet_wrap(~ variable, scales = "free_y") +
  labs(title = "Comparison of Numeric Variables by Sex",
       x = "Sex", y = "Value") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### Scatterplot Matrix

```{r scatterplot_matrix}
penguins_clean %>%
  select(species, sex, bill_length_mm, bill_depth_mm, flipper_length_mm, body_mass_g) %>%
  ggpairs(columns = 3:6, aes(color = sex, alpha = 0.5),
          upper = list(continuous = wrap("cor", size = 3))) +
  labs(title = "Scatterplot Matrix of Numeric Variables by Sex") +
  theme_minimal()
```

## Statistical Tests

Let's perform t-tests to compare the means of numeric variables between male and female penguins.

```{r t_tests}
numeric_vars <- c("bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")

t_test_results <- map_df(numeric_vars, function(var) {
  formula <- as.formula(paste(var, "~ sex"))
  test <- t.test(formula, data = penguins_clean)
  tibble(
    variable = var,
    t_statistic = test$statistic,
    p_value = test$p.value,
    mean_diff = diff(test$estimate)
  )
})

t_test_results
```

## Conclusions

Based on our exploratory data analysis of the Palmer Penguins dataset, we can draw the following conclusions:

1. The dataset contains information on three penguin species: Adelie, Chinstrap, and Gentoo.
2. There are differences in the distribution of males and females across species.
3. Male penguins generally have larger physical measurements (bill length, bill depth, flipper length, and body mass) compared to females.
4. The scatterplot matrix reveals correlations between various physical measurements, with patterns differing between males and females.
5. T-tests show statistically significant differences in mean values of all numeric variables between male and female penguins (all p-values < 0.05).

These insights will be valuable when building our logistic regression model to predict penguin sex based on physical characteristics.

```{r}

```

