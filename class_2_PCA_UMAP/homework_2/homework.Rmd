---
title: "Homework 2 - ML in Genomics: PCA and UMAP"
author: "Renan Escalante"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 1: PCA with Palmer Penguins Dataset

In this part, we'll explore Principal Component Analysis (PCA) using the Palmer Penguins dataset.

1. Load the necessary libraries and the Palmer Penguins dataset.

2. Create a correlation matrix for the numeric variables in the Palmer Penguins dataset. Visualize this correlation matrix.

3. Perform a Principal Component Analysis on the Palmer Penguins dataset using the following code:

```{r, eval=FALSE}
penguin_recipe <-
  recipe(~., data = penguins) %>% 
  update_role(species, island, sex, year, new_role = "id") %>% 
  step_naomit(all_predictors()) %>% 
  step_normalize(all_predictors()) %>%
  step_pca(all_predictors(), id = "pca") %>% 
  prep()

penguin_pca <- 
  penguin_recipe %>% 
  tidy(id = "pca") 

penguin_pca
```

4. What does the function "tidy" do when used directly on the object "penguin_recipe"? Test the function tidy with the 2 remaining values id of outside of "pca". What does this function do?

5. Use the following plot to create a loadings plot. What do the loadings represent? In SVD where to the values of the loadings come from?

```{r}
library(ggplot2)
penguin_pca %>%
  # mutate(terms = tidytext::reorder_within(terms, 
  #                                         abs(value), 
  #                                         component)) %>%
  ggplot(aes(abs(value), terms, fill = value > 0)) +
  geom_col() +
  facet_wrap(~component, scales = "free_y") +
  # tidytext::scale_y_reordered() +
  scale_fill_manual(values = c("#b6dfe2", "#0A537D")) +
  labs(
    x = "Absolute value of contribution",
    y = NULL, fill = "Positive?"
  ) 
```


5. What does the function "tidy" do on the recipe object? Create a scree plot showing the proportion of variance explained by each principal component.

6. Create a biplot of the first two principal components, coloring the points by penguin species.

7. Interpret the results of your PCA. Which variables contribute most to the first two principal components?

[Rest of the homework remains the same]